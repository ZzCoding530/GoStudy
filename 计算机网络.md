# TCP

## TCP流量控制

正常来说希望数据发送越快越好，但如果发送过快，就会造成接收方来不及接收，导致数据丢失

**流量控制的意义是让发送方的发送速率不要太快，要让接收方来得及接受**

流量控制的实现方法是**滑动窗口**

 

## TCP的拥塞控制

### 慢开始和拥塞避免

发送方维护几个变量

1. **拥塞窗口cwnd**：这个值是随着网络的拥塞程度动态变化的

   维护原则是：没出现拥塞就增大，出现拥塞就减小

   怎么算出现拥塞：发生超时重传

2.  **发送窗口swnd**：值和cwnd一样

3. **慢开始门限ssthresh**：

   拥塞窗口没达到门限时候，就用慢开始算法

   拥塞窗口大于门限了，就用拥塞避免算法

   相等时候，都行



拥塞窗口一开始是2倍2倍增长的，达到慢开始门限以后，只能+1+1+1。

若重传计时器超时，判断网络可能出现了拥塞，会将门限降低为发生拥塞时**cwnd**值的一半，并将cwnd重置为1





### 快重传和快恢复

使用快重传方法可以让发送方今早知道发生了报文段的丢失

要求接收方不要等自己发数据时候才捎带确认，而是要立即发送确认，即使收到了失序的报文段也要立即发出已收到的报文段的重复确认，发送方一旦**收到3个连续的重复确认**，就立即重传相应的报文段，而不是等待该报文段的超时重传计时器超时再重传。

发送方一旦接收到3个重复确认，开始执行快恢复算法

发送方将慢开始门限和拥塞窗口值调整为当前窗口的一半，开始执行拥塞避免算法

<img src="/Users/zhangchen/Desktop/截屏2021-01-21 下午7.03.15.png" alt="截屏2021-01-21 下午7.03.15" style="zoom:50%;" />

